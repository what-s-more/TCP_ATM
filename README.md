# TCP_ATM


## 项目简介  
本项目是一个基于 **C/S（客户端-服务器）架构** 的 ATM 模拟系统，支持基本的银行交易功能。包含两种客户端实现（PyQt5 和 Tkinter），服务器端通过 TCP 协议与客户端通信，用户数据存储在文本文件中。


## 功能特性  
- **用户认证**：通过“插卡”（输入卡号）和密码验证登录（密码为 6 位数字）。  
- **余额查询**：登录后可查询当前账户余额。  
- **取款操作**：支持输入金额取款。  
- **退卡/退出**：结束当前会话并断开连接。  
- **多客户端支持**：提供 PyQt5 和 Tkinter 两种客户端实现。  


## 环境要求  
- **Python 3.12**（推荐 3.8 及以上）。  
- **依赖库**：  
  - 服务器端：无额外依赖（仅需标准库 `socket`、`threading` 等）。  
  - 客户端（PyQt5）：需安装 `PyQt5`（`pip install PyQt5`）。  
  - 客户端（Tkinter）：Python 标准库，无需额外安装（部分系统可能需手动安装 Tk 环境）。  


## 目录结构  
```
ATM-System/
├── 1.py              # 服务器端核心代码（TCP 通信、用户数据管理）
├── 2.py              # PyQt5 客户端
├── 3.py              # Tkinter 客户端
└── information.txt   # 用户数据文件（格式：卡号,密码,余额）
```


## 快速开始  

### 1. 准备用户数据  
编辑 `information.txt` 文件，按以下格式添加用户：  
```
666,123456,9994.0   # 格式：卡号,密码（6位数字）,余额（浮点数）
```  


### 2. 启动服务器  
- 运行 `1.py`：  
  ```bash
  python 1.py
  ```  
- 服务器默认监听端口 `2525`，启动后输出 `The server is ready to receive` 表示成功。  


### 3. 启动客户端（任选一种）  

#### PyQt5 客户端 
- 运行 `2.py`：  
  ```bash
  python 2.py
  ```  
- 界面功能：  
  - **插卡**：输入固定卡号 `666`（与 `information.txt` 一致），自动跳转密码输入（6位数字）。  
  - **取款**：输入金额（需小于等于当前余额），提交后更新余额。  
  - **查询余额**：显示当前账户余额。  
  - **退卡**：断开连接并退出程序。  


#### Tkinter 客户端 
- 运行 `3.py`：  
  ```bash
  python 3.py
  ```  
- 操作流程：  
  1. 登录界面输入卡号和密码，点击“登录”。  
  2. 主界面支持查询余额、取款（存款功能暂未实现）、退出登录。  


## 注意事项  
- **服务器与客户端IP**：  
  - 服务器默认绑定所有网卡（`''`），客户端需根据服务器实际 IP 修改配置（`2.py` 中 `serverName` 或 `3.py` 中 `SERVER_IP`）。  
  - 本地测试时，客户端 IP 设为 `127.0.0.1`。  

- **用户数据文件**：  
  - 服务器端 `1.py` 中 `load_users` 函数默认读取 `information.txt`，需确保文件存在且格式正确。  

- **功能限制**：  
  - Tkinter 客户端的“存款”功能服务器端未实现，点击会提示“服务器暂不支持存款”。  


## 常见问题  
- **无法连接服务器**：  
  检查服务器是否已启动，确认客户端配置的 IP 和端口（默认 `2525`）与服务器一致。  

- **密码验证失败**：  
  确保输入的密码与 `information.txt` 中对应卡号的密码一致（6位数字）。  

- **取款失败（余额不足）**：  
  取款金额需小于等于当前账户余额（可通过“查询余额”确认）。  


## 贡献与反馈  
如有功能建议或 BUG 反馈，可通过 Issues 提交。  


**版本：1.0.0**  
**最后更新：2025-05-25**
